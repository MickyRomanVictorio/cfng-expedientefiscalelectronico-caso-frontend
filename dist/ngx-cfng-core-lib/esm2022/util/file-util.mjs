import { Injectable } from '@angular/core';
import * as i0 from "@angular/core";
export class FileUtil {
    constructor() {
        this.base64ToFile = (base64String) => {
            const binaryData = atob(base64String);
            const array = new Uint8Array(binaryData.length);
            for (let i = 0; i < binaryData.length; i++) {
                array[i] = binaryData.charCodeAt(i);
            }
            const blob = new Blob([array], { type: 'application/octet-stream' });
            try {
                return new File([blob], `${new Date().getTime()}.pdf`, {
                    type: 'application/octet-stream',
                });
            }
            catch (e) {
                console.error('Error creating File:', e);
                return null;
            }
        };
        this.descargarArchivoB64 = (archivoB64, nombreArchivo) => {
            const caracteresBase64 = atob(archivoB64);
            const numerosBytes = new Array(caracteresBase64.length);
            for (let i = 0; i < caracteresBase64.length; i++) {
                numerosBytes[i] = caracteresBase64.charCodeAt(i);
            }
            const arregloBytes = new Uint8Array(numerosBytes);
            const archivo = new Blob([arregloBytes], { type: 'application/pdf' });
            const enlaceDescarga = document.createElement('a');
            enlaceDescarga.href = URL.createObjectURL(archivo);
            enlaceDescarga.download = `${nombreArchivo}.pdf`;
            document.body.appendChild(enlaceDescarga);
            enlaceDescarga.click();
            document.body.removeChild(enlaceDescarga);
        };
        this.archivoFileToB64 = async (archivo) => {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.readAsDataURL(archivo);
                reader.onload = () => {
                    const archivoB64 = reader.result;
                    resolve(archivoB64.replace('data:application/pdf;base64,', ''));
                };
                reader.onerror = () => {
                    reject('');
                };
            });
        };
        this.trustUrlB64 = (archivoB64) => {
            return `data:application/pdf;base64,${archivoB64}`;
        };
        this.onlyB64File = (trustArchivoB64) => {
            return trustArchivoB64.replace('data:application/pdf;base64,', '');
        };
        this.formatoPesoArchivo = (bytes, decimalPoint = 2) => {
            if (bytes == 0)
                return '0 Bytes';
            let k = 1024;
            let sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];
            let i = Math.floor(Math.log(bytes) / Math.log(k));
            return (parseFloat((bytes / Math.pow(k, i)).toFixed(decimalPoint)) + ' ' + sizes[i]);
        };
        this.superaPesoPermitido = (archivo, persoPermitido) => {
            return (archivo.size > persoPermitido);
        };
        this.nombreArchivoExtenso = (archivo, longitudMaxima) => {
            return (archivo.name.length > longitudMaxima);
        };
        this.esExtensionValida = (archivo, extensionesPermitidas) => {
            let extensionArchivo = extensionesPermitidas.split(',').map((type) => type.trim());
            for (let type of extensionArchivo) {
                let acceptable = this.isWildcard(type) ?
                    this.getTypeClass(archivo.type) === this.getTypeClass(type) :
                    archivo.type == type || this.getFileExtension(archivo.name).toLowerCase() === type.toLowerCase();
                if (acceptable)
                    return true;
            }
            return false;
        };
    }
    getTypeClass(fileType) {
        return fileType.substring(0, fileType.indexOf('/'));
    }
    isWildcard(fileType) {
        return fileType.indexOf('*') !== -1;
    }
    getFileExtension(fileName) {
        return '.' + fileName.split('.').pop();
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "18.1.0", ngImport: i0, type: FileUtil, deps: [], target: i0.ɵɵFactoryTarget.Injectable }); }
    static { this.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: "12.0.0", version: "18.1.0", ngImport: i0, type: FileUtil, providedIn: 'root' }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "18.1.0", ngImport: i0, type: FileUtil, decorators: [{
            type: Injectable,
            args: [{
                    providedIn: 'root'
                }]
        }], ctorParameters: () => [] });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmlsZS11dGlsLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vcHJvamVjdHMvbmd4LWNmbmctY29yZS1saWIvdXRpbC9maWxlLXV0aWwudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFDLFVBQVUsRUFBQyxNQUFNLGVBQWUsQ0FBQzs7QUFLekMsTUFBTSxPQUFPLFFBQVE7SUFFbkI7UUFHQSxpQkFBWSxHQUFHLENBQUMsWUFBb0IsRUFBZSxFQUFFO1lBQ25ELE1BQU0sVUFBVSxHQUFHLElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQztZQUN0QyxNQUFNLEtBQUssR0FBRyxJQUFJLFVBQVUsQ0FBQyxVQUFVLENBQUMsTUFBTSxDQUFDLENBQUM7WUFDaEQsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLFVBQVUsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQztnQkFDM0MsS0FBSyxDQUFDLENBQUMsQ0FBQyxHQUFHLFVBQVUsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDdEMsQ0FBQztZQUNELE1BQU0sSUFBSSxHQUFHLElBQUksSUFBSSxDQUFDLENBQUMsS0FBSyxDQUFDLEVBQUUsRUFBRSxJQUFJLEVBQUUsMEJBQTBCLEVBQUUsQ0FBQyxDQUFDO1lBQ3JFLElBQUksQ0FBQztnQkFDSCxPQUFPLElBQUksSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsR0FBRyxJQUFJLElBQUksRUFBRSxDQUFDLE9BQU8sRUFBRSxNQUFNLEVBQUU7b0JBQ3JELElBQUksRUFBRSwwQkFBMEI7aUJBQ2pDLENBQUMsQ0FBQztZQUNMLENBQUM7WUFBQyxPQUFPLENBQUMsRUFBRSxDQUFDO2dCQUNYLE9BQU8sQ0FBQyxLQUFLLENBQUMsc0JBQXNCLEVBQUUsQ0FBQyxDQUFDLENBQUM7Z0JBQ3pDLE9BQU8sSUFBSSxDQUFDO1lBQ2QsQ0FBQztRQUNILENBQUMsQ0FBQztRQUVG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QUFJLENBQUMsV0FBVyxFQUFFLENBQUM7Z0JBQ25HLElBQUksVUFBVTtvQkFBRSxPQUFPLElBQUksQ0FBQztZQUM5QixDQUFDO1lBQ0QsT0FBTyxLQUFLLENBQUM7UUFDZixDQUFDLENBQUE7SUF2RkQsQ0FBQztJQXlGRCxZQUFZLENBQUMsUUFBZ0I7UUFDM0IsT0FBTyxRQUFRLENBQUMsU0FBUyxDQUFDLENBQUMsRUFBRSxRQUFRLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7SUFDdEQsQ0FBQztJQUVELFVBQVUsQ0FBQyxRQUFnQjtRQUN6QixPQUFPLFFBQVEsQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUM7SUFDdEMsQ0FBQztJQUVELGdCQUFnQixDQUFDLFFBQWdCO1FBQy9CLE9BQU8sR0FBRyxHQUFHLFFBQVEsQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxFQUFFLENBQUM7SUFDekMsQ0FBQzs4R0F0R1UsUUFBUTtrSEFBUixRQUFRLGNBRlAsTUFBTTs7MkZBRVAsUUFBUTtrQkFIcEIsVUFBVTttQkFBQztvQkFDVixVQUFVLEVBQUUsTUFBTTtpQkFDbkIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge0luamVjdGFibGV9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuXG5ASW5qZWN0YWJsZSh7XG4gIHByb3ZpZGVkSW46ICdyb290J1xufSlcbmV4cG9ydCBjbGFzcyBGaWxlVXRpbCB7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gIH1cblxuICBiYXNlNjRUb0ZpbGUgPSAoYmFzZTY0U3RyaW5nOiBzdHJpbmcpOiBGaWxlIHwgbnVsbCA9PiB7XG4gICAgY29uc3QgYmluYXJ5RGF0YSA9IGF0b2IoYmFzZTY0U3RyaW5nKTtcbiAgICBjb25zdCBhcnJheSA9IG5ldyBVaW50OEFycmF5KGJpbmFyeURhdGEubGVuZ3RoKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJpbmFyeURhdGEubGVuZ3RoOyBpKyspIHtcbiAgICAgIGFycmF5W2ldID0gYmluYXJ5RGF0YS5jaGFyQ29kZUF0KGkpO1xuICAgIH1cbiAgICBjb25zdCBibG9iID0gbmV3IEJsb2IoW2FycmF5XSwgeyB0eXBlOiAnYXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtJyB9KTtcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIG5ldyBGaWxlKFtibG9iXSwgYCR7bmV3IERhdGUoKS5nZXRUaW1lKCl9LnBkZmAsIHtcbiAgICAgICAgdHlwZTogJ2FwcGxpY2F0aW9uL29jdGV0LXN0cmVhbScsXG4gICAgICB9KTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBGaWxlOicsIGUpO1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICB9O1xuXG4gIGRlc2NhcmdhckFyY2hpdm9CNjQgPSAoXG4gICAgYXJjaGl2b0I2NDogc3RyaW5nLFxuICAgIG5vbWJyZUFyY2hpdm86IHN0cmluZ1xuICApOiB2b2lkID0+IHtcbiAgICBjb25zdCBjYXJhY3RlcmVzQmFzZTY0ID0gYXRvYihhcmNoaXZvQjY0KTtcbiAgICBjb25zdCBudW1lcm9zQnl0ZXMgPSBuZXcgQXJyYXkoY2FyYWN0ZXJlc0Jhc2U2NC5sZW5ndGgpO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY2FyYWN0ZXJlc0Jhc2U2NC5sZW5ndGg7IGkrKykge1xuICAgICAgbnVtZXJvc0J5dGVzW2ldID0gY2FyYWN0ZXJlc0Jhc2U2NC5jaGFyQ29kZUF0KGkpO1xuICAgIH1cbiAgICBjb25zdCBhcnJlZ2xvQnl0ZXMgPSBuZXcgVWludDhBcnJheShudW1lcm9zQnl0ZXMpO1xuICAgIGNvbnN0IGFyY2hpdm8gPSBuZXcgQmxvYihbYXJyZWdsb0J5dGVzXSwgeyB0eXBlOiAnYXBwbGljYXRpb24vcGRmJyB9KTtcbiAgICBjb25zdCBlbmxhY2VEZXNjYXJnYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcbiAgICBlbmxhY2VEZXNjYXJnYS5ocmVmID0gVVJMLmNyZWF0ZU9iamVjdFVSTChhcmNoaXZvKTtcbiAgICBlbmxhY2VEZXNjYXJnYS5kb3dubG9hZCA9IGAke25vbWJyZUFyY2hpdm99LnBkZmA7XG4gICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChlbmxhY2VEZXNjYXJnYSk7XG4gICAgZW5sYWNlRGVzY2FyZ2EuY2xpY2soKTtcbiAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGVubGFjZURlc2NhcmdhKTtcbiAgfTtcblxuICBhcmNoaXZvRmlsZVRvQjY0ID0gYXN5bmMgKGFyY2hpdm86IEZpbGUpOiBQcm9taXNlPHN0cmluZz4gPT4ge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZTxzdHJpbmc+KChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIGNvbnN0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XG4gICAgICByZWFkZXIucmVhZEFzRGF0YVVSTChhcmNoaXZvKTtcbiAgICAgIHJlYWRlci5vbmxvYWQgPSAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGFyY2hpdm9CNjQgPSByZWFkZXIucmVzdWx0IGFzIHN0cmluZztcbiAgICAgICAgcmVzb2x2ZShhcmNoaXZvQjY0LnJlcGxhY2UoJ2RhdGE6YXBwbGljYXRpb24vcGRmO2Jhc2U2NCwnLCAnJykpO1xuICAgICAgfTtcbiAgICAgIHJlYWRlci5vbmVycm9yID0gKCkgPT4ge1xuICAgICAgICByZWplY3QoJycpO1xuICAgICAgfTtcbiAgICB9KTtcbiAgfTtcblxuICB0cnVzdFVybEI2NCA9IChhcmNoaXZvQjY0OiBzdHJpbmcpOiBzdHJpbmcgPT4ge1xuICAgIHJldHVybiBgZGF0YTphcHBsaWNhdGlvbi9wZGY7YmFzZTY0LCR7YXJjaGl2b0I2NH1gO1xuICB9O1xuXG4gIG9ubHlCNjRGaWxlID0gKHRydXN0QXJjaGl2b0I2NDogc3RyaW5nKTogc3RyaW5nID0+IHtcbiAgICByZXR1cm4gdHJ1c3RBcmNoaXZvQjY0LnJlcGxhY2UoJ2RhdGE6YXBwbGljYXRpb24vcGRmO2Jhc2U2NCwnLCAnJyk7XG4gIH07XG5cbiAgZm9ybWF0b1Blc29BcmNoaXZvID0gKGJ5dGVzOiBudW1iZXIsIGRlY2ltYWxQb2ludDogbnVtYmVyID0gMikgPT4ge1xuICAgIGlmIChieXRlcyA9PSAwKSByZXR1cm4gJzAgQnl0ZXMnO1xuICAgIGxldCBrID0gMTAyNDtcbiAgICBsZXQgc2l6ZXMgPSBbJ0J5dGVzJywgJ0tCJywgJ01CJywgJ0dCJywgJ1RCJywgJ1BCJywgJ0VCJywgJ1pCJywgJ1lCJ107XG4gICAgbGV0IGkgPSBNYXRoLmZsb29yKE1hdGgubG9nKGJ5dGVzKSAvIE1hdGgubG9nKGspKTtcbiAgICByZXR1cm4gKFxuICAgICAgcGFyc2VGbG9hdCgoYnl0ZXMgLyBNYXRoLnBvdyhrLCBpKSkudG9GaXhlZChkZWNpbWFsUG9pbnQpKSArICcgJyArIHNpemVzW2ldXG4gICAgKTtcbiAgfTtcblxuICBzdXBlcmFQZXNvUGVybWl0aWRvID0gKGFyY2hpdm86IEZpbGUsIHBlcnNvUGVybWl0aWRvOiBudW1iZXIpOiBib29sZWFuID0+IHtcbiAgICByZXR1cm4gKCBhcmNoaXZvLnNpemUgPiBwZXJzb1Blcm1pdGlkbyApO1xuICB9XG5cbiAgbm9tYnJlQXJjaGl2b0V4dGVuc28gPSAoYXJjaGl2bzogRmlsZSwgbG9uZ2l0dWRNYXhpbWE6IG51bWJlcik6IGJvb2xlYW4gPT4ge1xuICAgIHJldHVybiAoIGFyY2hpdm8ubmFtZS5sZW5ndGggPiBsb25naXR1ZE1heGltYSApO1xuICB9XG5cbiAgZXNFeHRlbnNpb25WYWxpZGEgPSAoYXJjaGl2bzogRmlsZSwgZXh0ZW5zaW9uZXNQZXJtaXRpZGFzOiBzdHJpbmcpOiBib29sZWFuID0+IHtcbiAgICBsZXQgZXh0ZW5zaW9uQXJjaGl2byA9IGV4dGVuc2lvbmVzUGVybWl0aWRhcy5zcGxpdCgnLCcpLm1hcCgodHlwZSkgPT4gdHlwZS50cmltKCkpO1xuICAgIGZvciAobGV0IHR5cGUgb2YgZXh0ZW5zaW9uQXJjaGl2bykge1xuICAgICAgbGV0IGFjY2VwdGFibGUgPSB0aGlzLmlzV2lsZGNhcmQodHlwZSkgP1xuICAgICAgICB0aGlzLmdldFR5cGVDbGFzcyhhcmNoaXZvLnR5cGUpID09PSB0aGlzLmdldFR5cGVDbGFzcyh0eXBlKSA6XG4gICAgICAgIGFyY2hpdm8udHlwZSA9PSB0eXBlIHx8IHRoaXMuZ2V0RmlsZUV4dGVuc2lvbihhcmNoaXZvLm5hbWUpLnRvTG93ZXJDYXNlKCkgPT09IHR5cGUudG9Mb3dlckNhc2UoKTtcbiAgICAgIGlmIChhY2NlcHRhYmxlKSByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgZ2V0VHlwZUNsYXNzKGZpbGVUeXBlOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIHJldHVybiBmaWxlVHlwZS5zdWJzdHJpbmcoMCwgZmlsZVR5cGUuaW5kZXhPZignLycpKTtcbiAgfVxuXG4gIGlzV2lsZGNhcmQoZmlsZVR5cGU6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgIHJldHVybiBmaWxlVHlwZS5pbmRleE9mKCcqJykgIT09IC0xO1xuICB9XG5cbiAgZ2V0RmlsZUV4dGVuc2lvbihmaWxlTmFtZTogc3RyaW5nKTogc3RyaW5nIHtcbiAgICByZXR1cm4gJy4nICsgZmlsZU5hbWUuc3BsaXQoJy4nKS5wb3AoKTtcbiAgfVxuXG59XG4iXX0=