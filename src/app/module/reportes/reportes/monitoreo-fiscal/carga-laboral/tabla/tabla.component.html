<div class="flex justify-content-end mb-3">
  <button
    class="cfe-boton-secondary cfe-boton-m w-full sm:w-auto mr-0 sm:mr-3 mb-2 sm:mb-0 justify-content-start"
    (click)="exportarTipo('PDF')"
  >
    <fn-icon
      class="ml-1"
      [ico]="icono('iFileDownload')"
      height="1.6rem"
    ></fn-icon>
    <span class="family-poppin-bold">Exportar PDF</span>
  </button>

  <button
    class="cfe-boton-secondary cfe-boton-m w-full sm:w-auto justify-content-start"
    (click)="exportarTipo('Excel')"
  >
    <fn-icon class="ml-1" [ico]="icono('iTable')" height="1.6rem"></fn-icon>
    <span class="family-poppin-bold">Exportar Excel</span>
  </button>
</div>

@if(data() && tablaInfo()){
<p-table
  [value]="data()"
  [paginator]="true"
  [rows]="10"
  [showCurrentPageReport]="true"
  currentPageReportTemplate="Mostrando {first} a {last} de {totalRecords} registros"
  [rowsPerPageOptions]="[10, 25, 50]"
  styleClass="p-datatable-striped"
>
  <ng-template pTemplate="caption">
    <div class="text-center font-bold mb-3">
      <div>ESTADISTICA DE CARGA LABORAL</div>
      <div>DEL {{ tablaInfo().fechaInicio }} AL {{ tablaInfo().fechaFin }}</div>
    </div>
    <div class="mb-2">
      <div>DISTRITO FISCAL: {{ tablaInfo().distritoFiscal }}</div>
      <div>DEPENDENCIA FISCAL: {{ tablaInfo().dependenciaFiscal }}</div>
    </div>
  </ng-template>

  <ng-template pTemplate="header">
    <tr>
      <th>Nº</th>
      <th>Fiscal</th>
      <th>Resueltos</th>
      <th>% Resueltos</th>
      <th>En trámite</th>
      <th>% En trámite</th>
      <th>Total</th>
    </tr>
  </ng-template>
  <ng-template pTemplate="body" let-record let-i="rowIndex">
    <tr>
      <td>{{ i + 1 }}</td>
      <td>{{ record.fiscal }}</td>
      <td>{{ record.resueltos }}</td>
      <td>{{ record.porcentajeResuelto }}</td>
      <td>{{ record.tramites }}</td>
      <td>{{ record.porcentajeTramite }}</td>
      <td>{{ record.total }}</td>
    </tr>
  </ng-template>
  <ng-template pTemplate="footer">
    <tr>
      <td colspan="2" class="text-right font-bold">TOTALES:</td>
      <td class="font-bold">{{ tablaInfo().getTotalResueltos() }}</td>
      <td class="font-bold">
        {{ tablaInfo().getPorcentajeResueltosFormateado() }}
      </td>
      <td class="font-bold">{{ tablaInfo().getTotalEnTramite() }}</td>
      <td class="font-bold">
        {{ tablaInfo().getPorcentajeEnTramiteFormateado() }}
      </td>
      <td class="font-bold">{{ tablaInfo().getGrandTotal() }}</td>
    </tr>
  </ng-template>
  <ng-template pTemplate="emptymessage">
    <tr>
      <td class="no-before text-center" colspan="9">
        No se encontraron registros con los criterios de búsqueda ingresados
      </td>
    </tr>
  </ng-template>
</p-table>
}
