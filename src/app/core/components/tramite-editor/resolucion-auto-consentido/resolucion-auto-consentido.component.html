<!-- Se modifica código realizado por Ronald Melecio, con la finalidad de agregar flujo de tramites mixtos -->

@if (verFormulario) {

    @if (esTramiteCorrecto && !estadoRecibido && !soloLectura) {
      <mensaje-completar-informacion
        titulo="{{tramiteSeleccionado?.nombreTramite}}"
      />
    }
    <div>
      <form [formGroup]="formGroup">
        <div class="grid mt-3">

          <div class="col-12 lg:col-4">
            <div class="formgrid grid">
              <div class="field col-10">
                  <label for="fechaNotificacion" class="font-bold text-sm">Fecha de notificación</label>
                  <p-calendar
                    [dateFormat]="'dd/mm/yy'"
                    class="p-inputtext-lg cfe-calendar h-40"
                    [showIcon]="true"
                    dateMask
                    icon="cfe-calendar-icon"
                    placeholder="dd/mm/aaaa"
                    formControlName="fechaNotificacion"
                    appendTo="body"
                    [ngClass]="{'ng-invalid ng-dirty': formGroup.get('fechaNotificacion')?.invalid && formGroup.get('fechaNotificacion')?.touched}"
                  >
                  </p-calendar>
              </div>
              @if ( formGroup.get('fechaNotificacion')?.value ) {
                <div class="field col-1">
                  <label for="">&nbsp;</label>
                    <div class="mt-1">
                      <img [src]="iconAsset.obtenerRutaIcono('check-circle')" alt="guardado" class="pr-2 h-2rem">
                    </div>
                </div>
              }
            </div>
          </div>

          <div class="col-12 lg:col-3">
            <div class="formgrid grid">
              <div class="field col-10">
                  <label for="resultado" class="font-bold text-sm">Resultado</label>
                  <button class="cfe-boton-primary cfe-boton-lg w-full"
                          (click)="openModalSujetos()"
                  >Seleccionar consentido
                  </button>

              </div>
              @if ( cantidadSujetosTramite > 0 ) {
                <div class="field col-1">
                  <label for="">&nbsp;</label>
                    <div class="mt-1">
                      <img [src]="iconAsset.obtenerRutaIcono('check-circle')" alt="guardado" class="pr-2 h-2rem">
                    </div>
                </div>
              }
            </div>
          </div>

          <div class="field col-11">
            <label for="txtObservacion" class="font-bold text-sm">Observaciones (opcional)</label>
            <textarea pInputTextarea class="w-full text-md" rows="6" formControlName="txtObservacion" [maxLength]="longitudMaximaObservaciones"></textarea>
            <small
              class="block text-right mt-1"
              [ngClass]="{'p-error': cantidadCaracteresObservacion > longitudMaximaObservaciones }">
              {{cantidadCaracteresObservacion}}/{{longitudMaximaObservaciones}} máximo de caracteres
            </small>
          </div>
          @if ( formGroup.get('txtObservacion')?.value && formGroup.get('txtObservacion')?.value.length > 0 ) {
            <div class="col-1">
              <label for="">&nbsp;</label>
                <div class="mt-1">
                  <img [src]="iconAsset.obtenerRutaIcono('check-circle')" alt="guardado" class="pr-2 h-2rem">
                </div>
            </div>
          }
        </div>


      </form>
      @if ( !tramiteOriginadoEnEfe ) {

        <div class="field col-11 flex flex-column sm:flex-row justify-content-between mt-3">
          @if ( !soloLectura && !estadoRecibido ) {
            <a class="cfe-enlace" (click)="modalActualizarActoYTramite()">
              ¿Este documento no pertenece a este trámite?</a>
          } @else {
            <span></span>
          }

          @if ( esPosibleEditarFormulario ) {
            <p-button
              [disabled]="!validarForm"
              (onClick)="guardarFormularioMesa()"
              styleClass="p-button-lg cfe-boton-primary text-white family-poppin-bold btn-adjust-filter w-column-full">
              <span class="ml-4 mr-4">Guardar</span>
            </p-button>
          }
        </div>
      }

    </div>


} @else {
    <mensaje-interoperabilidad-pj
      [tieneActa]="true"
    ></mensaje-interoperabilidad-pj>
    <p-checkbox
      class="mb-2 mt-3"
      [binary]="true"
      inputId="motivo1"
      label="Generaré un acta de la audiencia"
      (onChange)="activarFormulario($event.checked)"
    ></p-checkbox>
}


