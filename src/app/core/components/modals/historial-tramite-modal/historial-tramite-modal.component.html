<div class="relative" style="max-width: 1500px">

  <div class="cfe-encabezado-modal mb-2">
    <span class="cfe-subtitulo-3 family-poppin-bold mr-5">
      {{ obtenerTitulo }}
    </span>
    <fn-icon
      onkeypress=""
      class="cfe-encabezado-cerrar"
      [ico]="iconUtil.obtenerIcono('iClose')"
      height="2rem"
      (click)="cerrarModal()"
    ></fn-icon>
  </div>

  <span
    class="encabezado-titulo cfe-subtitulo-3 cfe-semi-bold"
    [innerHTML]="subTituloModal"
  ></span>

  <div>
    <p-table
      [loading]="cargandoTabla"
      [value]="historialTramite"
      [rowHover]="true"
      [showCurrentPageReport]="true"
      responsiveLayout="stack"
    >
      <ng-template pTemplate="header">
        <tr>
          <th scope="">N°</th>
          <th scope="">Acción</th>
          <th scope="">Estado</th>
          <th scope="">Usuario Origen</th>
          <th scope="">Usuario(s) Destino</th>
          <th scope="">Observaciones / Comentarios</th>
          <th scope="">Fecha</th>
          @if (desdePendientesRevisar || desdeFirmados && esFiscal) {
            <th scope="">Restaurar versión del trámite</th>
          }

        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-tramite let-rowIndex="rowIndex">
        <tr class="">
          <td class="table_td_content_start">
            <span class="p-column-title">N°</span>
            {{ rowIndex + 1 }}
          </td>
          <td class="table_td_content_start">
            <span class="p-column-title">Acción</span>
            <div>{{ tramite.accion }}</div>
          </td>
          <td class="table_td_content_start">
            <span class="p-column-title">Estado</span>
            {{ tramite.estado }}
          </td>
          <td class="table_td_content_start">
            <span class="p-column-title">Usuario Origen</span>
            <div>{{ tramite.usuarioOrigen }}</div>
            <div>
              <span><strong>{{ capitalizeWords(tramite.usuarioOrigenCodigoPerfil) }}</strong></span>
            </div>
          </td>
          <td class="table_td_content_start">
            <span class="p-column-title">Usuario(s) Destino</span>
            <div>{{ tramite.usuarioDestino }}</div>
            <div>

              <span><strong>{{ capitalizeWords(tramite.usuarioDestinoPerfil) }}</strong></span>
            </div>
          </td>
          <td class="table_td_content_start">
            <span class="p-column-title">Observaciones / Comentarios</span>
            <div>{{ tramite.observaciones }}</div>
          </td>
          <td class="table_td_content_start">
            <span class="p-column-title">Fecha</span>
            <div>{{ formatHoraSinEspacio(tramite.fecha) }}</div>
          </td>
          @if (showOptions(tramite)) {
            <td>
              <span class="p-column-title">Restaurar versión del trámite</span>
              <div class="flex justify-content-center">
                <button
                  class="btn-accion btn-accion--gris"
                  (click)="visorTramitePDF(tramite)"
                  [ngStyle]="{ backgroundColor: '#f19700' }"
                >
                  <fn-icon
                    [ico]="iconUtil.obtenerIcono('iEye')"
                    height="1.4rem"
                    [ngStyle]="{ color: '#ffff' }"
                  ></fn-icon>
                </button>
                @if (validarBotonRestaurar(tramite, rowIndex)) {
                  <button
                  class="btn-accion btn-accion--gris ml-2"
                  (click)="
                    restaurarTramite(
                      tramite.fecha,
                      tramite.idBandejaActoTramite,
                      tramite.idDocumentoVersiones,
                      tramite.accion,
                      tramite.idActoTramiteCaso
                    )
                  "
                >
                  <fn-icon
                    [ico]="iconUtil.obtenerIcono('iRestaurar')"
                    height="1.4rem"
                  ></fn-icon>
                </button>
                } @else {
                  <button class="btn-accion btn-accion--gris ml-2" style="opacity: 0; cursor: context-menu;">
                  </button>
                }

              </div>
            </td>
          }

        </tr>
      </ng-template>
      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="8" style="text-align: center">
            No se encontraron registros
          </td>
        </tr>
      </ng-template>
    </p-table>
    <app-paginator
      [query]="paginacionCondicion"
      [items]="paginacionConfiguracion"
      [rowsPerPageOptions]="[]"
      [resetPage]="paginacionReiniciar"
      (paginate)="eventoCambiarPagina($event)"
    ></app-paginator>
  </div>
</div>
