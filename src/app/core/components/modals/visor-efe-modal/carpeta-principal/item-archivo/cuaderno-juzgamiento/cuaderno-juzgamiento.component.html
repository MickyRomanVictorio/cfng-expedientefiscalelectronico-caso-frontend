<!-- datos principales -->
<div class="cuaderno px-2">
    <div class="cabecera_cuaderno">
      <div class="flex">
        <div class="flex-grow-1 flex align-items-center justify-content-center font-bold">
          {{titulo}}
        </div>
        <div class="flex-shrink-1 flex align-items-center justify-content-center font-bold pr-4">
          <a class="abrir_cuaderno" href="#"  (click)="toggleCuaderno($event)">
            <i class="text-xl pi pi-chevron-{{isCuadernoOpen===true?'up':'down'}}"></i>
          </a>
        </div>
    </div>
    </div>
      <div  [@toggleCuaderno]="isCuadernoOpen ? 'open' : 'closed'" class="cuaderno_cuerpo">
        <p-table [value]="cuadernosJuzgamiento" [rowHover]="true" responsiveLayout="stack">
          <ng-template pTemplate="body" let-rowIndex="rowIndex" let-califPrelPrepInte>
            <tr #filaArchivoRef [id]="'fila-'+califPrelPrepInte.correlativo"
              [style.backgroundColor]="colorFondoFilaArchivo(califPrelPrepInte)">
              <td style="vertical-align: top;" class="pl-2 pr-0">
                <div class="flex">
                  <p-checkbox [(ngModel)]="califPrelPrepInte.seleccionado" binary="true"
                    (onChange)="eventoSeleccionarFila(califPrelPrepInte, $event)"></p-checkbox>
                  <span class="pl-1">{{ califPrelPrepInte.correlativo }}.</span>
                </div>
              </td>
              <td style="vertical-align: top;" class="pl-0 cursor-pointer"
                (click)="eventoSeleccionarArchivo(califPrelPrepInte)">
                <div>
        
                  <div class="text-md">
                    <span class="font-semibold">Acto:</span> {{califPrelPrepInte.nombreActoProcesal}}
                  </div>
                  <div class="text-md">
                    <span class="font-semibold">Trámite:</span> {{califPrelPrepInte.nombreTramite}}
                  </div>
                  <div class="text-xs text-600">Fecha de emisión: {{califPrelPrepInte.fechaEmision}}</div>
        
        
                  <div class="text-xs text-600">Fecha de registro: {{califPrelPrepInte.fechaCreacion}}</div>
                </div>
              </td>
              <td style="vertical-align: top;" class="relative">
                <div style="min-width: 150px;">
                  <div class="flex align-content-center">
                    <div class="w-full">
                      <div
                        class="bg-red-500 text-white px-2 py-2 text-center border-round cursor-pointer transition-all transition-duration-200 hover:bg-red-700">
                        pdf</div>
                      <div class="text-xs flex  justify-content-between">
                        <div>{{califPrelPrepInte.pesoFormateado}}</div>
                        <div>{{califPrelPrepInte.folioTotal}} Folio{{califPrelPrepInte.folioTotal===1?'':'s'}}</div>
                      </div>
                    </div>
                    <div style="width: 50px;" class="text-right pl-3">
                      <fn-icon class="cursor-pointer" (click)="eventoDescargarArchivo(califPrelPrepInte)"
                        [ico]="obtenerIcono('iDownload')" height="2.1rem"></fn-icon>
                    </div>
                  </div>
                  <div class="text-sm pt-1 text-600">
                    Folio inicial:{{califPrelPrepInte.folioInicio}} - Folio final: {{califPrelPrepInte.folioFin}}
                  </div>
                  @if (califPrelPrepInte.fuenteInvestigacion && califPrelPrepInte.fuenteInvestigacion.length > 0) {
                  <div class="flex align-items-center justify-content-end pt-2">
                    <div>
                      <img src="{{ iconAsset.obtenerRutaIcono('documento') }}" style="width: 1.2rem;" alt="Icono" />
                      <img src="{{ iconAsset.obtenerRutaIcono('video') }}" style="width: 1.2rem;" alt="Icono" class="mx-1" />
                      <img src="{{ iconAsset.obtenerRutaIcono('audio') }}" style="width: 1.2rem;" alt="Icono" />
                    </div>
                    <div class="pl-4 pr-1 cursor-pointer">
                      <a href="javascript:void(0)"
                        (click)="califPrelPrepInte.mostrarContenido = !califPrelPrepInte.mostrarContenido">
                        <i class="text-xl pi pi-chevron-{{califPrelPrepInte.mostrarContenido===true?'up':'down'}}"></i>
                      </a>
                    </div>
                  </div>
                  }
                  <div *ngIf="califPrelPrepInte.cargoDocumento" class="absolute top-0 right-0 h-full">
                    <app-boton-cargo [tramite]="califPrelPrepInte" [cargoDocumento]="califPrelPrepInte.cargoDocumento"></app-boton-cargo>
                  </div>
                </div>
              </td>
            </tr>
            <ng-container
              *ngTemplateOutlet="datoArhivoFuenteInvestigacionRef; context: {datosArchivo: califPrelPrepInte}"></ng-container>
            @if (rowIndex == cuadernosJuzgamiento.length -1 ) {
            <!-- Espacio -->
            <tr>
              <td colspan="3" class="p-0" style="border: none; height: 0.5rem; background-color: #fff;">
              </td>
            </tr>
            }
        
          </ng-template>
        
          <ng-template pTemplate="emptymessage">
            <tr>
              <td colspan="3" class="text-center">
                No se encontraron registros.
              </td>
            </tr>
          </ng-template>
        </p-table>
      </div>
      
      <!-- datos cuaderno incidental-->
      
    
    </div>
    

    <ng-template #datoArhivoFuenteInvestigacionRef let-datosArchivo="datosArchivo">
        @if (datosArchivo.fuenteInvestigacion && datosArchivo.fuenteInvestigacion.length > 0) {
        <tr>
          <td colspan="3" class="relative p-0 text-right pr-2" style="border: none !important">
            <div class="bg-white absolute px-3 font-semibold left-0"
              style="top: -0.9rem; display: inline-block; white-space: nowrap;">Fuente de Investigación</div>
          </td>
        </tr>
        @for (fuenteInvestigacion of datosArchivo.fuenteInvestigacion; track $index) {
        <tr [ngClass]="{ 'hidden': !datosArchivo.mostrarContenido }" #filaArchivoRef
          [id]="'fila-'+fuenteInvestigacion.correlativo" [style.backgroundColor]="colorFondoFilaArchivo(fuenteInvestigacion)">
          <td class="p-0 text-right" style="border: none !important; border-bottom: #ccc solid 1px !important;">
            <p-checkbox [(ngModel)]="fuenteInvestigacion.seleccionado" binary="true"
              (onChange)="eventoSeleccionarFila(fuenteInvestigacion, $event)"></p-checkbox>
          </td>
          <td class="p-0" style="border: none !important; border-bottom: #ccc solid 1px !important;">
            <div class="py-3 cursor-pointer" (click)="eventoSeleccionarArchivo(fuenteInvestigacion)">
              <div class="flex align-items-center">
                <div class="px-1">
                  <img src="{{ iconAsset.obtenerRutaIcono( fuenteInvestigacion.nombreTipoArchivo.toLowerCase() ) }}"
                    style="width: 1.2rem;" alt="Icono" />
                </div>
                <div class="pl-1">
                  <div class="text-md">{{fuenteInvestigacion.nombre}}</div>
                  <div class="text-sm text-600">{{fuenteInvestigacion.pesoFormateado}}</div>
                </div>
              </div>
            </div>
          </td>
          <td style="vertical-align: top;" style="border: none !important; border-bottom: #ccc solid 1px !important;">
            <div>
              <div class="flex align-content-center">
                <div class="w-full">
                  <div (click)="eventoSeleccionarArchivo(fuenteInvestigacion)"
                    class="text-white text-xs px-2 py-1 text-center border-round cursor-pointer formato-{{fuenteInvestigacion.nombreTipoArchivo.toLowerCase()}}">
                    {{fuenteInvestigacion.nombreExtension}}</div>
                </div>
                <div style="width: 50px;" class="text-right pl-3">
                  <fn-icon class="cursor-pointer" (click)="eventoDescargarArchivo(fuenteInvestigacion)"
                    [ico]="obtenerIcono('iDownload')" height="2.1rem"></fn-icon>
                </div>
              </div>
            </div>
          </td>
        </tr>
        }
        @if (datosArchivo.mostrarContenido) {
        <tr>
          <td colspan="3" class="py-2" style="border: none !important; background-color: #e4e4e4 !important;">
          </td>
        </tr>
        }@else {
        <tr>
          <td colspan="3" class="py-3" style="border: none !important; background-color: #fff !important;">
          </td>
        </tr>
        }
        }
      </ng-template>
    